<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SportZone - Qu·∫£n l√Ω S·∫£n ph·∫©m</title>
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Enhanced Product Management Styles */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin-top: 20px; }
        .product-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; }
        .product-image { width: 100%; height: 150px; background: #f5f5f5; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; }
        .product-title { font-weight: bold; margin-bottom: 8px; color: #333; }
        .product-price { color: #e74c3c; font-size: 18px; font-weight: bold; margin-bottom: 8px; }
        .product-category { background: #3498db; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; display: inline-block; margin-bottom: 10px; }
        .product-actions { display: flex; gap: 8px; margin-top: 15px; }
        .btn-edit { background: #f39c12; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; }
        .btn-delete { background: #e74c3c; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; }
        .add-product-btn { background: #27ae60; color: white; border: none; padding: 12px 20px; border-radius: 6px; cursor: pointer; margin-bottom: 20px; }
        .search-bar { width: 100%; max-width: 300px; padding: 10px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 20px; }
        .filter-section { display: flex; gap: 15px; margin-bottom: 20px; align-items: center; flex-wrap: wrap; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { background: white; margin: 50px auto; padding: 30px; border-radius: 8px; width: 90%; max-width: 500px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        .form-group textarea { height: 80px; resize: vertical; }
        .stock-badge { padding: 2px 6px; border-radius: 10px; font-size: 11px; font-weight: bold; }
        .stock-low { background: #e74c3c; color: white; }
        .stock-medium { background: #f39c12; color: white; }
        .stock-high { background: #27ae60; color: white; }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h2><i class="fas fa-dumbbell"></i> SportZone</h2>
                <p class="admin-info">Admin: <span id="adminEmail"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="48292c252126083b38273a3c3227262d662b2725">[email&#160;protected]</a></span></p>
            </div>
            <nav class="sidebar-nav">
                <a href="admin-final.html#overview" class="nav-item">
                    <i class="fas fa-tachometer-alt"></i> T·ªïng quan
                </a>
                <a href="#products" class="nav-item active">
                    <i class="fas fa-box"></i> S·∫£n ph·∫©m
                </a>
                <a href="admin-final.html#orders" class="nav-item">
                    <i class="fas fa-shopping-cart"></i> ƒê∆°n h√†ng
                </a>
                <a href="admin-final.html#users" class="nav-item">
                    <i class="fas fa-users"></i> Ng∆∞·ªùi d√πng
                </a>
                <a href="#logout" class="nav-item logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <h1><i class="fas fa-box"></i> Qu·∫£n l√Ω S·∫£n ph·∫©m</h1>

            <!-- Filter & Search Section -->
            <div class="filter-section">
                <input type="text" class="search-bar" placeholder="üîç T√¨m ki·∫øm s·∫£n ph·∫©m..." id="searchInput">
                <select id="categoryFilter" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    <option value="all">T·∫•t c·∫£ danh m·ª•c</option>
                    <option value="gym">Ph√≤ng Gym</option>
                    <option value="cardio">Cardio</option>
                    <option value="accessories">Ph·ª• ki·ªán</option>
                    <option value="supplements">Th·ª±c ph·∫©m b·ªï sung</option>
                </select>
                <select id="stockFilter" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    <option value="all">T·∫•t c·∫£ t√¨nh tr·∫°ng</option>
                    <option value="in-stock">C√≤n h√†ng</option>
                    <option value="low-stock">S·∫Øp h·∫øt</option>
                    <option value="out-of-stock">H·∫øt h√†ng</option>
                </select>
            </div>

            <!-- Action Buttons -->
            <div style="margin-bottom: 20px;">
                <button class="add-product-btn" onclick="openAddProductModal()">
                    <i class="fas fa-plus"></i> Th√™m s·∫£n ph·∫©m m·ªõi
                </button>
                <button class="btn btn-secondary" onclick="refreshProducts()" style="margin-left: 10px;">
                    <i class="fas fa-sync"></i> L√†m m·ªõi
                </button>
            </div>

            <!-- Products Grid -->
            <div class="product-grid" id="productsGrid">
                <!-- Sample Products -->
                <div class="product-card" data-category="gym" data-stock="15">
                    <div class="product-image">
                        <i class="fas fa-dumbbell" style="font-size: 48px; color: #ccc;"></i>
                    </div>
                    <div class="product-title">T·∫° ƒê∆°n Professional 20kg</div>
                    <div class="product-category">Ph√≤ng Gym</div>
                    <div class="product-price">1.250.000 ‚Ç´</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>T·ªìn kho: 15</span>
                        <span class="stock-badge stock-medium">C√≤n √≠t</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn-edit" onclick="editProduct(1)"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-delete" onclick="deleteProduct(1)"><i class="fas fa-trash"></i> X√≥a</button>
                    </div>
                </div>

                <div class="product-card" data-category="cardio" data-stock="8">
                    <div class="product-image">
                        <i class="fas fa-running" style="font-size: 48px; color: #ccc;"></i>
                    </div>
                    <div class="product-title">M√°y Ch·∫°y B·ªô Home Fitness</div>
                    <div class="product-category">Cardio</div>
                    <div class="product-price">15.990.000 ‚Ç´</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>T·ªìn kho: 8</span>
                        <span class="stock-badge stock-low">S·∫Øp h·∫øt</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn-edit" onclick="editProduct(2)"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-delete" onclick="deleteProduct(2)"><i class="fas fa-trash"></i> X√≥a</button>
                    </div>
                </div>

                <div class="product-card" data-category="accessories" data-stock="50">
                    <div class="product-image">
                        <i class="fas fa-tshirt" style="font-size: 48px; color: #ccc;"></i>
                    </div>
                    <div class="product-title">B√¨nh N∆∞·ªõc Th·ªÉ Thao 750ml</div>
                    <div class="product-category">Ph·ª• ki·ªán</div>
                    <div class="product-price">199.000 ‚Ç´</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>T·ªìn kho: 50</span>
                        <span class="stock-badge stock-high">Nhi·ªÅu</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn-edit" onclick="editProduct(3)"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-delete" onclick="deleteProduct(3)"><i class="fas fa-trash"></i> X√≥a</button>
                    </div>
                </div>

                <div class="product-card" data-category="supplements" data-stock="25">
                    <div class="product-image">
                        <i class="fas fa-pills" style="font-size: 48px; color: #ccc;"></i>
                    </div>
                    <div class="product-title">Whey Protein Isolate 2kg</div>
                    <div class="product-category">Th·ª±c ph·∫©m b·ªï sung</div>
                    <div class="product-price">1.890.000 ‚Ç´</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>T·ªìn kho: 25</span>
                        <span class="stock-badge stock-high">Nhi·ªÅu</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn-edit" onclick="editProduct(4)"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-delete" onclick="deleteProduct(4)"><i class="fas fa-trash"></i> X√≥a</button>
                    </div>
                </div>

                <div class="product-card" data-category="gym" data-stock="0">
                    <div class="product-image">
                        <i class="fas fa-weight-hanging" style="font-size: 48px; color: #ccc;"></i>
                    </div>
                    <div class="product-title">Gh·∫ø T·∫≠p T·∫° ƒêa NƒÉng</div>
                    <div class="product-category">Ph√≤ng Gym</div>
                    <div class="product-price">3.450.000 ‚Ç´</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>T·ªìn kho: 0</span>
                        <span class="stock-badge stock-low">H·∫øt h√†ng</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn-edit" onclick="editProduct(5)"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-delete" onclick="deleteProduct(5)"><i class="fas fa-trash"></i> X√≥a</button>
                    </div>
                </div>

                <div class="product-card" data-category="cardio" data-stock="12">
                    <div class="product-image">
                        <i class="fas fa-bicycle" style="font-size: 48px; color: #ccc;"></i>
                    </div>
                    <div class="product-title">Xe ƒê·∫°p T·∫≠p Th·ªÉ D·ª•c</div>
                    <div class="product-category">Cardio</div>
                    <div class="product-price">5.990.000 ‚Ç´</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>T·ªìn kho: 12</span>
                        <span class="stock-badge stock-medium">C√≤n √≠t</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn-edit" onclick="editProduct(6)"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-delete" onclick="deleteProduct(6)"><i class="fas fa-trash"></i> X√≥a</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle">Th√™m s·∫£n ph·∫©m m·ªõi</h3>
            <form id="productForm">
                <div class="form-group">
                    <label>T√™n s·∫£n ph·∫©m:</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>Danh m·ª•c:</label>
                    <select id="productCategory" required>
                        <option value="">Ch·ªçn danh m·ª•c</option>
                        <option value="gym">Ph√≤ng Gym</option>
                        <option value="cardio">Cardio</option>
                        <option value="accessories">Ph·ª• ki·ªán</option>
                        <option value="supplements">Th·ª±c ph·∫©m b·ªï sung</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Gi√° (‚Ç´):</label>
                    <input type="number" id="productPrice" required min="0">
                </div>
                <div class="form-group">
                    <label>T·ªìn kho:</label>
                    <input type="number" id="productStock" required min="0">
                </div>
                <div class="form-group">
                    <label>M√¥ t·∫£:</label>
                    <textarea id="productDescription"></textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" onclick="closeModal()" style="background: #95a5a6; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">H·ªßy</button>
                    <button type="submit" style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="js/supabase.js"></script>
    <script>
        // Auth check
        document.addEventListener('DOMContentLoaded', function() {
            const userSession = localStorage.getItem('userSession');
            if (!userSession) {
                window.location.href = 'admin-login-debug.html';
                return;
            }
            
            try {
                const session = JSON.parse(userSession);
                document.getElementById('adminEmail').textContent = session.email;
            } catch (error) {
                console.error('Auth error:', error);
                localStorage.removeItem('userSession');
                window.location.href = 'admin-login-debug.html';
            }
        });

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function() {
            filterProducts();
        });

        document.getElementById('categoryFilter').addEventListener('change', function() {
            filterProducts();
        });

        document.getElementById('stockFilter').addEventListener('change', function() {
            filterProducts();
        });

        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const stockFilter = document.getElementById('stockFilter').value;
            const productCards = document.querySelectorAll('.product-card');

            productCards.forEach(card => {
                const title = card.querySelector('.product-title').textContent.toLowerCase();
                const category = card.dataset.category;
                const stock = parseInt(card.dataset.stock);
                
                let showCard = true;

                // Search filter
                if (searchTerm && !title.includes(searchTerm)) {
                    showCard = false;
                }

                // Category filter
                if (categoryFilter !== 'all' && category !== categoryFilter) {
                    showCard = false;
                }

                // Stock filter
                if (stockFilter !== 'all') {
                    if (stockFilter === 'out-of-stock' && stock > 0) showCard = false;
                    if (stockFilter === 'low-stock' && stock >= 10) showCard = false;
                    if (stockFilter === 'in-stock' && stock === 0) showCard = false;
                }

                card.style.display = showCard ? 'block' : 'none';
            });
        }

        // Modal functions
        function openAddProductModal() {
            document.getElementById('modalTitle').textContent = 'Th√™m s·∫£n ph·∫©m m·ªõi';
            document.getElementById('productForm').reset();
            document.getElementById('productModal').style.display = 'block';
        }

        function editProduct(id) {
            document.getElementById('modalTitle').textContent = 'Ch·ªânh s·ª≠a s·∫£n ph·∫©m';
            // Pre-fill form with product data (simulate)
            document.getElementById('productModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        function deleteProduct(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')) {
                alert('S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c x√≥a!');
                // Remove product logic here
            }
        }

        function refreshProducts() {
            alert('ƒê√£ l√†m m·ªõi danh s√°ch s·∫£n ph·∫©m!');
            // Refresh logic here
        }

        // Form submission
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
            closeModal();
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('productModal');
            if (event.target === modal) {
                closeModal();
            }
        });

        function logout() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?')) {
                localStorage.removeItem('userSession');
                window.location.href = 'admin-login-debug.html';
            }
        }
    </script>
</body>
</html>
